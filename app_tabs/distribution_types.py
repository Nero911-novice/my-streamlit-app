import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats
from .utils import create_download_button


def create_distribution_plot(dist_name: str):
    """–°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è"""
    fig, ax = plt.subplots(figsize=(10, 6))
    if dist_name == "–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ (–ì–∞—É—Å—Å–æ–≤–æ)":
        mu, sigma = 0, 1
        x = np.linspace(-4, 4, 1000)
        y = stats.norm.pdf(x, mu, sigma)
        ax.plot(x, y, linewidth=3, color='blue')
        ax.fill_between(x, y, alpha=0.3)
        ax.axvline(mu, color='red', linestyle='--', linewidth=2, label=f'Œº = {mu}')
        ax.axvline(mu+sigma, color='green', linestyle=':', linewidth=2, label=f'Œº+œÉ = {mu+sigma}')
        ax.axvline(mu-sigma, color='green', linestyle=':', linewidth=2, label=f'Œº-œÉ = {mu-sigma}')
        ax.set_title("–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ N(0,1)", fontsize=14)
    elif dist_name == "–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ":
        a, b = 0, 2
        x = np.linspace(-0.5, 2.5, 1000)
        y = np.where((x >= a) & (x <= b), 1/(b-a), 0)
        ax.plot(x, y, linewidth=3, color='green')
        ax.fill_between(x, y, alpha=0.3)
        ax.axvline((a+b)/2, color='red', linestyle='--', linewidth=2, label=f'Œº = {(a+b)/2}')
        ax.set_title(f"–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ U({a},{b})", fontsize=14)
    elif dist_name == "–ë–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ":
        n, p = 20, 0.3
        x = np.arange(0, n+1)
        y = stats.binom.pmf(x, n, p)
        ax.bar(x, y, alpha=0.7, color='orange', edgecolor='black')
        ax.axvline(n*p, color='red', linestyle='--', linewidth=2, label=f'Œº = {n*p:.1f}')
        ax.set_title(f"–ë–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ B({n},{p})", fontsize=14)
    elif dist_name == "–ü—É–∞—Å—Å–æ–Ω–∞":
        lam = 5
        x = np.arange(0, 15)
        y = stats.poisson.pmf(x, lam)
        ax.bar(x, y, alpha=0.7, color='purple', edgecolor='black')
        ax.axvline(lam, color='red', linestyle='--', linewidth=2, label=f'Œº = {lam}')
        ax.set_title(f"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ü—É–∞—Å—Å–æ–Ω–∞ (Œª = {lam})", fontsize=14)
    elif dist_name == "–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ":
        lam = 1
        x = np.linspace(0, 5, 1000)
        y = stats.expon.pdf(x, scale=1/lam)
        ax.plot(x, y, linewidth=3, color='red')
        ax.fill_between(x, y, alpha=0.3)
        ax.axvline(1/lam, color='blue', linestyle='--', linewidth=2, label=f'Œº = {1/lam}')
        ax.set_title(f"–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (Œª = {lam})", fontsize=14)
    elif dist_name == "–õ–æ–≥–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ":
        mu, sigma = 0, 0.5
        x = np.linspace(0.01, 5, 1000)
        y = stats.lognorm.pdf(x, s=sigma, scale=np.exp(mu))
        ax.plot(x, y, linewidth=3, color='brown')
        ax.fill_between(x, y, alpha=0.3)
        mean_ln = np.exp(mu + sigma**2/2)
        ax.axvline(mean_ln, color='red', linestyle='--', linewidth=2, label=f'Œº = {mean_ln:.2f}')
        ax.set_title("–õ–æ–≥–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ", fontsize=14)
    elif dist_name == "–•–∏-–∫–≤–∞–¥—Ä–∞—Ç":
        df = 5
        x = np.linspace(0.01, 15, 1000)
        y = stats.chi2.pdf(x, df)
        ax.plot(x, y, linewidth=3, color='darkgreen')
        ax.fill_between(x, y, alpha=0.3)
        ax.axvline(df, color='red', linestyle='--', linewidth=2, label=f'Œº = {df}')
        ax.set_title(f"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ œá¬≤ (df = {df})", fontsize=14)
    elif dist_name == "–°—Ç—å—é–¥–µ–Ω—Ç–∞ (t)":
        df = 5
        x = np.linspace(-4, 4, 1000)
        y_t = stats.t.pdf(x, df)
        y_norm = stats.norm.pdf(x)
        ax.plot(x, y_t, linewidth=3, label=f"t-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (df={df})", color='darkblue')
        ax.plot(x, y_norm, linestyle='--', linewidth=2, label="N(0,1)", color='gray')
        ax.fill_between(x, y_t, alpha=0.3)
        ax.set_title(f"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –°—Ç—å—é–¥–µ–Ω—Ç–∞ (df = {df})", fontsize=14)
    ax.set_xlabel("x", fontsize=12)
    ax.set_ylabel("f(x) –∏–ª–∏ P(X=x)", fontsize=12)
    ax.legend(fontsize=10)
    ax.grid(True, alpha=0.3)
    fig.tight_layout()
    return fig


def display_distribution_info(dist_name: str):
    """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏"""
    info = {
        "–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ (–ì–∞—É—Å—Å–æ–≤–æ)": {
            "description": "–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –∫–æ–ª–æ–∫–æ–ª–æ–æ–±—Ä–∞–∑–Ω–∞—è –∫—Ä–∏–≤–∞—è, –æ–ø–∏—Å—ã–≤–∞—é—â–∞—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ –≤–µ–ª–∏—á–∏–Ω—ã –≤–æ–∫—Ä—É–≥ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.",
            "parameters": "Œº (—Å—Ä–µ–¥–Ω–µ–µ), œÉ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)",
            "applications": [
                "üßë‚Äçü§ù‚Äçüßë –†–æ—Å—Ç –∏ –≤–µ—Å –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏",
                "üî¨ –û—à–∏–±–∫–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π",
                "üß† IQ-—Ç–µ—Å—Ç—ã –∏ –ø—Å–∏—Ö–æ–º–µ—Ç—Ä–∏—è",
                "üíπ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏",
                "üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤"
            ],
            "formula": "f(x) = (1/œÉ‚àö2œÄ) √ó e^(-(x-Œº)¬≤/2œÉ¬≤)"
        },
        "–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ": {
            "description": "–í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è.",
            "parameters": "a (–º–∏–Ω–∏–º—É–º), b (–º–∞–∫—Å–∏–º—É–º)",
            "applications": [
                "üé≤ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª",
                "üöå –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞",
                "üéØ –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏",
                "üî¢ –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π"
            ],
            "formula": "f(x) = 1/(b-a) –¥–ª—è a ‚â§ x ‚â§ b"
        },
        "–ë–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ": {
            "description": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—Ö–æ–≤ –≤ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —á–∏—Å–ª–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∏—Å–ø—ã—Ç–∞–Ω–∏–π —Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —É—Å–ø–µ—Ö–∞.",
            "parameters": "n (—á–∏—Å–ª–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–π), p (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞)",
            "applications": [
                "üß™ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ",
                "üè≠ –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏",
                "üìä –°–æ—Ü–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø—Ä–æ—Å—ã",
                "üéØ –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è",
                "üó≥Ô∏è –ò–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã"
            ],
            "formula": "P(X=k) = C(n,k) √ó p^k √ó (1-p)^(n-k)"
        },
        "–ü—É–∞—Å—Å–æ–Ω–∞": {
            "description": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π, –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–∏—Ö –∑–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏.",
            "parameters": "Œª (–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å/—Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ —Å–æ–±—ã—Ç–∏–π)",
            "applications": [
                "üìû –ó–≤–æ–Ω–∫–∏ –≤ call-—Ü–µ–Ω—Ç—Ä",
                "üöó –î–æ—Ä–æ–∂–Ω–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è",
                "üè≠ –î–µ—Ñ–µ–∫—Ç—ã –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ",
                "üåü –†–∞–¥–∏–æ–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–∞—Å–ø–∞–¥",
                "üìß –ü–æ—Ç–æ–∫ email-—Å–æ–æ–±—â–µ–Ω–∏–π"
            ],
            "formula": "P(X=k) = (Œª^k √ó e^(-Œª))/k!"
        },
        "–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ": {
            "description": "–í—Ä–µ–º—è –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏—è–º–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ü—É–∞—Å—Å–æ–Ω–∞; —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –¥–æ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.",
            "parameters": "Œª (–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π)",
            "applications": [
                "‚öôÔ∏è –í—Ä–µ–º—è –¥–æ –ø–æ–ª–æ–º–∫–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è",
                "üè™ –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏",
                "‚òéÔ∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤",
                "üîã –í—Ä–µ–º—è —Ä–∞–∑—Ä—è–¥–∫–∏ –±–∞—Ç–∞—Ä–µ–∏",
                "üåßÔ∏è –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–µ–∂–¥—É –æ—Å–∞–¥–∫–∞–º–∏"
            ],
            "formula": "f(t) = Œª √ó e^(-Œªt) –¥–ª—è t ‚â• 0"
        },
        "–õ–æ–≥–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ": {
            "description": "–ï—Å–ª–∏ –ª–æ–≥–∞—Ä–∏—Ñ–º —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã –∏–º–µ–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —Ç–æ —Å–∞–º–∞ –≤–µ–ª–∏—á–∏–Ω–∞ –∏–º–µ–µ—Ç –ª–æ–≥–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ.",
            "parameters": "Œº, œÉ (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–æ–≥–∞—Ä–∏—Ñ–º–∞)",
            "applications": [
                "üí∞ –î–æ—Ö–æ–¥—ã –Ω–∞—Å–µ–ª–µ–Ω–∏—è",
                "üìÅ –†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤",
                "‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á",
                "üíπ –¶–µ–Ω—ã –Ω–∞ –∞–∫—Ü–∏–∏",
                "üè† –°—Ç–æ–∏–º–æ—Å—Ç—å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏"
            ],
            "formula": "f(x) = (1/xœÉ‚àö2œÄ) √ó e^(-(ln(x)-Œº)¬≤/2œÉ¬≤)"
        },
        "–•–∏-–∫–≤–∞–¥—Ä–∞—Ç": {
            "description": "–°—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω.",
            "parameters": "k (—Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã)",
            "applications": [
                "üß™ –ö—Ä–∏—Ç–µ—Ä–∏–π —Å–æ–≥–ª–∞—Å–∏—è",
                "üìä –û—Ü–µ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏",
                "üî¨ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑",
                "üìà –ê–Ω–∞–ª–∏–∑ —Ç–∞–±–ª–∏—Ü —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏"
            ],
            "formula": "f(x) = (1/2^(k/2)Œì(k/2)) √ó x^(k/2-1) √ó e^(-x/2)"
        },
        "–°—Ç—å—é–¥–µ–Ω—Ç–∞ (t)": {
            "description": "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø—Ä–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –ø–æ–ø—É–ª—è—Ü–∏–∏ –∏ –º–∞–ª—ã—Ö –≤—ã–±–æ—Ä–∫–∞—Ö.",
            "parameters": "ŒΩ (—Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã)",
            "applications": [
                "üìä t-—Ç–µ—Å—Ç—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–∏—Ö",
                "üîç –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã",
                "üß™ –ê–Ω–∞–ª–∏–∑ –º–∞–ª—ã—Ö –≤—ã–±–æ—Ä–æ–∫",
                "üìà –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑"
            ],
            "formula": "f(t) = Œì((ŒΩ+1)/2)/(‚àöŒΩœÄ Œì(ŒΩ/2)) √ó (1+t¬≤/ŒΩ)^(-(ŒΩ+1)/2)"
        }
    }
    if dist_name in info:
        dist_info = info[dist_name]
        st.markdown(f"### {dist_name}")
        st.markdown("**üìù –û–ø–∏—Å–∞–Ω–∏–µ:**")
        st.write(dist_info['description'])
        st.markdown(f"**‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** {dist_info['parameters']}")
        if 'formula' in dist_info:
            st.markdown("**üßÆ –§–æ—Ä–º—É–ª–∞:**")
            st.code(dist_info['formula'])
        st.markdown("**üéØ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**")
        for app in dist_info['applications']:
            st.write(f"‚Ä¢ {app}")
        if dist_name == "–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ (–ì–∞—É—Å—Å–æ–≤–æ)":
            st.markdown("""**üîë –ö–ª—é—á–µ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞:**\n‚Ä¢ –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω–µ–≥–æ\n‚Ä¢ 68-95-99.7 –ø—Ä–∞–≤–∏–ª–æ (–∑–∞–∫–æ–Ω —Ç—Ä—ë—Ö —Å–∏–≥–º)\n‚Ä¢ –û—Å–Ω–æ–≤–∞ –¥–ª—è –¶–ü–¢ –∏ –º–Ω–æ–≥–∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤""")
        elif dist_name == "–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ":
            st.markdown("""**üîë –ö–ª—é—á–µ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞:**\n‚Ä¢ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–º—è—Ç–∏ (memoryless property)\n‚Ä¢ –¢—è–∂–µ–ª—ã–π –ø—Ä–∞–≤—ã–π —Ö–≤–æ—Å—Ç\n‚Ä¢ –°–≤—è–∑–∞–Ω–æ —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ü—É–∞—Å—Å–æ–Ω–∞""")


def distribution_types_tab():
    """–í–∫–ª–∞–¥–∫–∞ —Ç–∏–ø–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π"""
    if "visited_tabs" not in st.session_state:
        st.session_state.visited_tabs = set()
    st.session_state.visited_tabs.add("–¢–∏–ø—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π")

    st.header("–¢–∏–ø—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π")
    st.markdown("–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π, –∏—Ö —Å–≤–æ–π—Å—Ç–≤ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π.")

    chosen_dist = st.selectbox(
        "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:",
        [
            "–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ (–ì–∞—É—Å—Å–æ–≤–æ)", "–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ", "–ë–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ", "–ü—É–∞—Å—Å–æ–Ω–∞",
            "–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ", "–õ–æ–≥–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ", "–•–∏-–∫–≤–∞–¥—Ä–∞—Ç", "–°—Ç—å—é–¥–µ–Ω—Ç–∞ (t)"
        ]
    )

    col1, col2 = st.columns([3, 2])
    with col1:
        fig = create_distribution_plot(chosen_dist)
        st.pyplot(fig, use_container_width=True)
        create_download_button(fig, f"{chosen_dist.lower().replace(' ', '_')}.png")
    with col2:
        display_distribution_info(chosen_dist)

    st.markdown("---")
    st.subheader("üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π")
    comparison_type = st.radio("–¢–∏–ø —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:", ["–¢–∞–±–ª–∏—Ü–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫", "–í–∏–∑—É–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ"])
    if comparison_type == "–¢–∞–±–ª–∏—Ü–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫":
        comparison_data = {
            "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ": ["–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ", "–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ", "–ë–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ", "–ü—É–∞—Å—Å–æ–Ω–∞", "–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ"],
            "–¢–∏–ø": ["–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ", "–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ", "–î–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ", "–î–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ", "–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ"],
            "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã": ["Œº, œÉ", "a, b", "n, p", "Œª", "Œª"],
            "–°—Ä–µ–¥–Ω–µ–µ": ["Œº", "(a+b)/2", "n¬∑p", "Œª", "1/Œª"],
            "–î–∏—Å–ø–µ—Ä—Å–∏—è": ["œÉ¬≤", "(b-a)¬≤/12", "n¬∑p¬∑(1-p)", "Œª", "1/Œª¬≤"]
        }
        st.table(comparison_data)
    else:
        comparison_mode = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:", ["–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", "–î–∏—Å–∫—Ä–µ—Ç–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è"])
        fig, ax = plt.subplots(figsize=(12, 6))
        if comparison_mode == "–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è":
            x = np.linspace(-4, 8, 1000)
            ax.plot(x, stats.norm.pdf(x), label="–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ N(0,1)", linewidth=2)
            ax.plot(x, stats.uniform.pdf(x, 0, 2), label="–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ U(0,2)", linewidth=2)
            ax.plot(x[x>=0], stats.expon.pdf(x[x>=0]), label="–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ Œª=1", linewidth=2)
            ax.set_title("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π")
            ax.set_xlim(-1, 6)
        else:
            x = np.arange(0, 21)
            ax.bar(x-0.2, stats.binom.pmf(x, 20, 0.25), width=0.4, alpha=0.7, label="–ë–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ B(20,0.25)")
            ax.bar(x+0.2, stats.poisson.pmf(x, 5), width=0.4, alpha=0.7, label="–ü—É–∞—Å—Å–æ–Ω–∞ Œª=5")
            ax.set_title("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π")
        ax.legend()
        ax.grid(True, alpha=0.3)
        ax.set_xlabel("x")
        ax.set_ylabel("f(x) –∏–ª–∏ P(X=x)")
        fig.tight_layout()
        st.pyplot(fig, use_container_width=True)
        create_download_button(fig, f"comparison_{comparison_mode.lower().replace(' ', '_')}.png")

    st.markdown("---")
    st.subheader("üéØ –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ?")
    with st.expander("–ü–æ—à–∞–≥–æ–≤—ã–π –≥–∏–¥ –ø–æ –≤—ã–±–æ—Ä—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è"):
        st.markdown(
            """**–®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö**
        - üî¢ **–î–∏—Å–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞): –ë–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ, –ü—É–∞—Å—Å–æ–Ω–∞, –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ
        - üìà **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (–ª—é–±—ã–µ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞): –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ, –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ, –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ

        **–®–∞–≥ 2: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–∏—Ä–æ–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞**
        - ‚è±Ô∏è **–í—Ä–µ–º—è –¥–æ —Å–æ–±—ã—Ç–∏—è** ‚Üí –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ
        - üìä **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥** ‚Üí –ü—É–∞—Å—Å–æ–Ω–∞
        - üéØ **–ò—Å–ø—ã—Ç–∞–Ω–∏—è —É—Å–ø–µ—Ö/–Ω–µ—É–¥–∞—á–∞** ‚Üí –ë–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ
        - üîî **–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤–æ–∫—Ä—É–≥ —Å—Ä–µ–¥–Ω–µ–≥–æ** ‚Üí –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ
        - üí∞ **–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –ø—Ä–∞–≤—ã–º —Ö–≤–æ—Å—Ç–æ–º** ‚Üí –õ–æ–≥–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ

        **–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö**
        - üìä **QQ-–≥—Ä–∞—Ñ–∏–∫–∏** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
        - üß™ **–ö—Ä–∏—Ç–µ—Ä–∏–∏ —Å–æ–≥–ª–∞—Å–∏—è** (–ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞, œá¬≤)
        - üëÅÔ∏è **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑** –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º

        **–®–∞–≥ 4: –£—á—Ç–∏—Ç–µ –¶–ü–¢**
        - üìà **–°—Ä–µ–¥–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–æ–∫** ‚Üí —á–∞—Å—Ç–æ –ø—Ä–∏–±–ª–∏–∂–∞—é—Ç—Å—è –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É
        - üé≤ **–°—É–º–º—ã —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω** ‚Üí —Å—Ç—Ä–µ–º—è—Ç—Å—è –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É"""
        )
    st.markdown("---")
    st.subheader("üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è")
    col1, col2 = st.columns(2)
    with col1:
        st.markdown(
            """**–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**
        - [Seeing Theory](https://seeing-theory.brown.edu/) - –≤–∏–∑—É–∞–ª—å–Ω–∞—è —Ç–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
        - [Distribution Calculator](https://stattrek.com/online-calculator) - –æ–Ω–ª–∞–π–Ω –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã
        - [Wolfram Alpha](https://wolframalpha.com/) - –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤"""
        )
    with col2:
        st.markdown(
            """**–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:**
        - [Wikipedia: List of distributions](https://en.wikipedia.org/wiki/List_of_probability_distributions)
        - [Khan Academy: Statistics](https://www.khanacademy.org/math/statistics-probability)
        - [MIT OpenCourseWare](https://ocw.mit.edu/) - –∫—É—Ä—Å—ã –ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ"""
        )
